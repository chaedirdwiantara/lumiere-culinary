"use strict";(()=>{var e={};e.id=432,e.ids=[432],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},85477:e=>{e.exports=require("punycode")},12781:e=>{e.exports=require("stream")},57310:e=>{e.exports=require("url")},59796:e=>{e.exports=require("zlib")},72500:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>m,patchFetch:()=>_,requestAsyncStorage:()=>d,routeModule:()=>l,serverHooks:()=>g,staticGenerationAsyncStorage:()=>h});var o={};t.r(o),t.d(o,{GET:()=>c,POST:()=>u});var s=t(49303),i=t(88716),a=t(60670),p=t(87070),n=t(1926);async function c(e){try{let{searchParams:r}=new URL(e.url),t={category:r.get("category")||void 0,is_featured:"true"===r.get("is_featured")||void 0,is_published:"false"!==r.get("is_published"),search:r.get("search")||void 0,page:parseInt(r.get("page")||"1"),limit:parseInt(r.get("limit")||"12"),sort_by:r.get("sort_by")||"created_at",sort_order:r.get("sort_order")||"desc"},o=(0,n.l)(),s=o.from("photos").select(`
        *,
        categories:photo_categories(
          category:categories(*)
        ),
        quotes:photo_quotes(*),
        media:photo_media(*)
      `);void 0!==t.is_published&&(s=s.eq("is_published",t.is_published)),void 0!==t.is_featured&&(s=s.eq("is_featured",t.is_featured)),t.search&&(s=s.or(`title.ilike.%${t.search}%,description.ilike.%${t.search}%`)),t.category&&(s=s.eq("photo_categories.categories.slug",t.category));let{count:i}=await o.from("photos").select("*",{count:"exact",head:!0}),a=((t.page||1)-1)*(t.limit||12),c=a+(t.limit||12)-1;s=s.order(t.sort_by||"created_at",{ascending:"asc"===t.sort_order}).range(a,c);let{data:u,error:l}=await s;if(l)return console.error("Error fetching photos:",l),p.NextResponse.json({error:"Failed to fetch photos"},{status:500});let d={data:u||[],total:i||0,page:t.page||1,limit:t.limit||12,totalPages:Math.ceil((i||0)/(t.limit||12))};return p.NextResponse.json(d)}catch(e){return console.error("Error in GET /api/photos:",e),p.NextResponse.json({error:"Internal server error"},{status:500})}}async function u(e){try{let{title:r,description:t,file_path:o,file_size:s,mime_type:i,width:a,height:c,camera_model:u,lens:l,focal_length:d,aperture:h,shutter_speed:g,iso:m,taken_at:_,location:x,is_featured:f=!1,is_published:I=!0,sort_order:y=0,categories:v=[]}=await e.json();if(!r||!o)return p.NextResponse.json({error:"Title and file_path are required"},{status:400});let E=(0,n.l)(),{data:q,error:R}=await E.from("photos").insert({title:r,description:t,file_path:o,file_size:s,mime_type:i,width:a,height:c,camera_model:u,lens:l,focal_length:d,aperture:h,shutter_speed:g,iso:m,taken_at:_,location:x,is_featured:f,is_published:I,sort_order:y}).select().single();if(R)return console.error("Error creating photo:",R),p.NextResponse.json({error:"Failed to create photo"},{status:500});if(v.length>0&&q){let e=v.map(e=>({photo_id:q.id,category_id:e})),{error:r}=await E.from("photo_categories").insert(e);r&&console.error("Error associating categories:",r)}return p.NextResponse.json({data:q},{status:201})}catch(e){return console.error("Error in POST /api/photos:",e),p.NextResponse.json({error:"Internal server error"},{status:500})}}let l=new s.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/photos/route",pathname:"/api/photos",filename:"route",bundlePath:"app/api/photos/route"},resolvedPagePath:"D:\\WORKS\\WEB\\NEXTJS\\LUMIERE\\src\\app\\api\\photos\\route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:d,staticGenerationAsyncStorage:h,serverHooks:g}=l,m="/api/photos/route";function _(){return(0,a.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:h})}},1926:(e,r,t)=>{t.d(r,{O:()=>i,l:()=>a});var o=t(43974);let s="https://iezdixmqlkcfmkdivdzr.supabase.co",i=(0,o.eI)(s,"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImllemRpeG1xbGtjZm1rZGl2ZHpyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDY0MDM5MjYsImV4cCI6MjA2MTk3OTkyNn0.-3rQMwjBLPypSHg4S5IRrcUOl7KnCDQUMrzWxBZoqE8"),a=()=>{let e=process.env.SUPABASE_SERVICE_ROLE_KEY;return(0,o.eI)(s,e)}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[948,972,974],()=>t(72500));module.exports=o})();